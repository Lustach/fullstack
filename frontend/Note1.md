Vue-router имеет метод beforeEach, который вызывается перед обработкой каждого маршрута. Здесь мы можем определить наше условие проверки и ограничить доступ пользователей. Метод принимает три параметра — to, from и next. to это маршрут куда пользователь хочет пойти, from маршрут откуда он идет, next это функция обратного вызова, которая продолжит обработку запроса пользователя.

Мы проверяем несколько вещей:

если для маршрута указан requiresAuth, проверяем токен jwt, показывающий, что пользователь вошел в систему.
если для маршрута указан requiresAuth и оно предназначено только для пользователей с правами администратора, проверяем аутентификацию и проверяем, является ли пользователь администратором.
если для маршрута указан guest, проверяем, вошел ли пользователь в систему
Далее мы перенаправляем пользователя на основании того, что мы проверили. Мы используем имя маршрута для перенаправления, поэтому убедитесь, что вы используете правильные имена для своего приложения.
Мы сохраняем токен jwt и информацию о пользователе в localStorage, чтобы мы могли получить к ней доступ позже из любой части нашего приложения. Далее, мы перенаправляем пользователя к той части нашего приложения, к которой он пытался получить доступ, если была такая попытка была иначе перенаправляем на вход в систему. Если пользователь снова попадает на страницу входа, он будет перенаправлен на страницу в зависимости от его типа.
